<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      /**
       * アップロードボタンが押された時の処理
       */
      function csvUpload(formObject) {
        // アップロード用のダイアログを表示
        google.script.run.withSuccessHandler(closeDialog)
                         .uploadProcess(formObject);

        // 読み込み中はメッセージのみ表示
        document.getElementById('myForm').style.display = 'none';
        document.getElementById('message').innerHTML = 'インポート中...';
      }
      
      /**
       * 処理が終わったらダイアログを閉じる
       */
      function closeDialog() {
        google.script.host.close();
      }
    </script>
  </head>

  <body>
    <form id='myForm'>
      <input name="myFile" type="file" />
      <button onclick="csvUpload(this.parentNode);">インポート</button> 
    </form>
    <div id='message'></div>
 </body>
</html>